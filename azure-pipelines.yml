trigger:
- master

queue:
  name: "kubernetes-vsts-agents"

steps:

- task: DownloadSecureFile@1
  displayName: "Download SSH Private Key for GitHub"
  name: "id_rsa"
  inputs:
      secureFile: "Github"

- script: |
    ls -la $AGENT_TEMPDIRECTORY/
    git remote add github git@github.com:9spokes/go.git
    test -d ~/.ssh || mkdir -p ~/.ssh
    mv $AGENT_TEMPDIRECTORY/id_rsa ~/.ssh/id_rsa
  displayName: 'Configure Git Remote'

- script: |
    git push github master
  displayName: 'Sync to Github'
